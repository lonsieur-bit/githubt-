<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุชุณุฌูู ุฌุฏูุฏ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDA2DTjy0BkcUl9CGNTymS3Ng48bkWZK0Y&libraries=places&language=ar&region=SA"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div id="splash" class="splash">
        <div class="splash-card">
            <img src="onecare__5_-removebg-preview.png" alt="OneCare" class="splash-logo">
            <p class="splash-title"></p>
            <p class="splash-sub"></p>
        </div>
    </div>

    <div class="container">
        <div class="registration-wrapper">
            <!-- Step 1: Account Type Selection -->
            <div id="step1" class="registration-step active">
                <div class="header">
                    <h1>ุชุณุฌูู ุฌุฏูุฏ</h1>
                </div>

                <div class="account-type-selector">
                    <button class="type-btn" data-type="shipper">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 3h15v13H1zM16 8h4l3 3v5h-7V8z"></path>
                            <path d="M5.5 21a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"></path>
                            <path d="M18.5 21a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"></path>
                        </svg>
                        ุชุณุฌูู ูุชุดุงููุญ
                    </button>
                    <button class="type-btn active" data-type="buyer">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <path d="M16 10a4 4 0 0 1-8 0"></path>
                        </svg>
                        ุชุณุฌูู ููุดุชุฑู
                    </button>
                </div>

                <div class="footer-link">
                    <p>ูุฏูู ุญุณุงุจ ุ <a href="#" onclick="openLogin(event)">ุณุฌู ุฏุฎููู</a></p>
                </div>
            </div>

            <!-- Step 2: Sign Up Form -->
            <div id="step2" class="registration-step">
                <div class="header">
                    <button class="back-btn" onclick="goToStep(1)">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="15 18 9 12 15 6"></polyline>
                        </svg>
                    </button>
                    <h1>ุชุณุฌูู ุฌุฏูุฏ</h1>
                </div>

                <form id="signupForm" class="registration-form">
                    <div class="form-group">
                        <label for="username">ุงุณู ุงููุณุชุฎุฏู <span class="required">*</span></label>
                        <input type="text" id="username" name="username" placeholder="ุฃุฏุฎู ุงุณู ุงููุณุชุฎุฏู" required>
                    </div>

                    <div class="form-group phone-group">
                        <label for="phone">ุฑูู ุงูุฌูุงู <span class="required">*</span></label>
                        <div class="phone-field">
                            <div class="phone-control">
                                <button type="button" class="phone-flag-btn" aria-label="ุงุฎุชุฑ ุงูุฏููุฉ">๐ธ๐ฆ +966</button>
                                <span class="phone-separator"></span>
                                <input type="tel" id="phone" name="phone" class="phone-input" placeholder="5xxxxxxxx" required>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="city">ุงููุฏููุฉ <span class="required">*</span></label>
                        <div class="select-wrapper">
                            <select id="city" name="city" required>
                                <option value="">ุงุฎุชุฑ ุงููุฏููุฉ</option>
                                <option value="riyadh">ุงูุฑูุงุถ</option>
                                <option value="jeddah">ุฌุฏุฉ</option>
                                <option value="madinah">ุงููุฏููุฉ ุงููููุฑุฉ</option>
                                <option value="hail">ุญุงูู</option>
                                <option value="abha">ุงุจูุง</option>
                                <option value="khamis">ุฎููุณ ูุดูุท</option>
                                <option value="hafar">ุญูุฑ ุงูุจุงุทู</option>
                                <option value="ula">ุงูุนูุงูุฉ</option>
                            </select>
                            <svg class="select-arrow" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                    </div>

                    <button type="submit" class="submit-btn">ุงููู</button>
                </form>

                <div class="footer-link">
                    <p>ูุฏูู ุญุณุงุจ ุ <a href="#" onclick="openLogin(event)">ุณุฌู ุฏุฎููู</a></p>
                </div>
            </div>

            <!-- Step 3: Location -->
            <div id="step3" class="registration-step">
                <div class="header">
                    <button class="back-btn" onclick="goToStep(2)">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="15 18 9 12 15 6"></polyline>
                        </svg>
                    </button>
                    <h1>ุชุณุฌูู ุฌุฏูุฏ</h1>
                </div>

                <div class="location-section">
                    <label class="location-label">ุงููุตูู ูููููุน <span class="required">*</span></label>
                    <div class="map-container">
                        <div id="map" class="map-display"></div>
                    </div>
                    <div id="locationInfo" class="location-info"></div>
                </div>

                <button type="button" class="submit-btn" id="registerBtn">ุชุณุฌูู</button>

                <div class="footer-link">
                    <p>ูุฏูู ุญุณุงุจ ุ <a href="#" onclick="openLogin(event)">ุณุฌู ุฏุฎููู</a></p>
                </div>
            </div>
        </div>

        <!-- App Shell (shown after registration/login) -->
        <div id="appShell" class="app-shell">
            <header class="app-header">
                <h1 id="appTitle">ุงูุฑุฆูุณูุฉ</h1>
            </header>

            <main class="app-content">
                <section id="homeSection" class="app-section active">
                    <div class="home-hero">
                        <div class="hero-text">
                            <p class="hero-eyebrow">ุฃูููุง ุจู</p>
                            <h2>ุงุจุฏุฃ ุทูุจู ุฃู ุชุงุจุน ุนุฑูุถู</h2>
                            <p class="hero-sub">ุฅุฏุงุฑุฉ ุทูุจุงุชู ูุนุฑูุถ ุงูููุฑุฏูู ูู ููุงู ูุงุญุฏ.</p>
                        </div>
                    </div>

                    <div class="quick-actions">
                        <button class="pill" data-action="newRequest">+ ุทูุจ ุฌุฏูุฏ</button>
                        <button class="pill light" data-action="offers">ุนุฑุถ ุงูุนุฑูุถ</button>
                        <button class="pill light" data-action="profile">ุงูููู ุงูุดุฎุตู</button>
                    </div>

                    <div class="card-grid">
                        <button class="card featured" data-action="newRequest">
                            <div>
                                <p class="card-title">ุฅูุดุงุก ุทูุจ</p>
                                <p class="card-desc">ุญุฏุฏ ุงููุฆุฉ ูุงููุตู ูุชุญุตู ุนูู ุนุฑูุถ ุณุฑูุนุฉ</p>
                            </div>
                        </button>
                        <button class="card" data-action="offers">
                            <div>
                                <p class="card-title">ุนุฑูุถู</p>
                                <p class="card-desc">ุฑุงุฌุน ุงูุฃุณุนุงุฑ ููุงุฑู ุฃูุถู ุงูุฎูุงุฑุงุช</p>
                            </div>
                        </button>
                        <button class="card" data-action="profile">
                            <div>
                                <p class="card-title">ูููู</p>
                                <p class="card-desc">ุจูุงูุงุชูุ ูุฏููุ ูุชูุถููุงุชู</p>
                            </div>
                        </button>
                    </div>
                </section>

                <section id="requestSection" class="app-section">
                    <div class="stepper">
                        <div class="step active" data-step="brand"></div>
                        <div class="step" data-step="year"></div>
                        <div class="step" data-step="details"></div>
                    </div>

                    <div id="stepBrand" class="section-block request-step active">
                        <h2>ุงุฎุชุฑ ููุงูุฉ ุงูุณูุงุฑุฉ</h2>
                        <input type="hidden" id="reqBrand" name="reqBrand" value="">
                        <div class="brand-grid" id="brandGrid">
                            <button class="brand-tile" data-brand="ford" style="background-image:url('1.png');" aria-label="Ford"></button>
                            <button class="brand-tile" data-brand="mazda" style="background-image:url('2.png');" aria-label="Mazda"></button>
                            <button class="brand-tile" data-brand="nissan" style="background-image:url('3.png');" aria-label="Nissan"></button>
                            <button class="brand-tile" data-brand="kia" style="background-image:url('4.png');" aria-label="Kia"></button>
                            <button class="brand-tile" data-brand="hyundai" style="background-image:url('5.png');" aria-label="Hyundai"></button>
                            <button class="brand-tile placeholder" data-brand="gmc" aria-label="GMC">GMC</button>
                            <button class="brand-tile placeholder" data-brand="chevrolet" aria-label="Chevrolet">Chevy</button>
                            <button class="brand-tile placeholder" data-brand="mercedes" aria-label="Mercedes">Mercedes</button>
                            <button class="brand-tile placeholder" data-brand="porsche" aria-label="Porsche">Porsche</button>
                            <button class="brand-tile placeholder" data-brand="lexus" aria-label="Lexus">Lexus</button>
                            <button class="brand-tile placeholder" data-brand="bmw" aria-label="BMW">BMW</button>
                            <button class="brand-tile placeholder" data-brand="audi" aria-label="Audi">Audi</button>
                            <button class="brand-tile placeholder" data-brand="vw" aria-label="Volkswagen">VW</button>
                        </div>
                        <div class="step-actions">
                            <button class="pill" id="brandNext">ุงูุชุงูู</button>
                        </div>
                    </div>

                    <div id="stepYear" class="section-block request-step">
                        <h2>ุงุฎุชุฑ ุณูุฉ ุงูุตูุน</h2>
                        <div class="form-group">
                            <select id="reqYear">
                                <option value="">ุงุฎุชุฑ ุงูุณูุฉ</option>
                                <option>2025</option>
                                <option>2024</option>
                                <option>2023</option>
                                <option>2022</option>
                                <option>2021</option>
                                <option>2020</option>
                                <option>2019</option>
                                <option>2018</option>
                            </select>
                        </div>
                        <div class="step-actions">
                            <button class="ghost-btn" data-back="brand">ุงูุณุงุจู</button>
                            <button class="pill" id="yearNext">ุงูุชุงูู</button>
                        </div>
                    </div>

                    <div id="stepDetails" class="section-block request-step">
                        <div class="detail-header">
                            <div class="detail-title">
                                <div class="progress-line"><span></span></div>
                            </div>
                        </div>

                        <div class="car-summary">
                            <div>
                                <p class="summary-label">ุงูุณูุงุฑุฉ</p>
                                <p id="summaryCar" class="summary-value">โ</p>
                            </div>
                        </div>

                        <div class="section-divider"></div>
                        <h3 class="section-title">ุชูุงุตูู ุงููุทุนุฉ ุงูุชู ุชุญุชุงุฌูุง</h3>

                        <div class="form-group required">
                            <label>ููุน ุงููุทุนุฉ</label>
                            <select id="reqCategory">
                                <option value="">ุงุฎุชุฑ ุงููุฆุฉ</option>
                                <option value="body">ูุทุนุฉ ุฎุงุฑุฌูุฉ</option>
                                <option value="interior">ูุทุนุฉ ุฏุงุฎููุฉ</option>
                                <option value="electrical">ูุทุนุฉ ููุฑุจุงุฆูุฉ</option>
                                <option value="mechanical">ูุทุนุฉ ูููุงููููุฉ</option>
                                <option value="accessory">ุงูุณุณูุงุฑ</option>
                            </select>
                        </div>

                        <div class="form-group required">
                            <label>ุงุณู ุงููุทุนุฉ</label>
                            <input type="text" id="reqPartName" placeholder="ูุซู: ุจุทุงุฑูุฉ">
                        </div>

                        <div class="form-group">
                            <label>ูุตู</label>
                            <textarea id="reqNotes" rows="4" placeholder="ุตู ูุง ุชุญุชุงุฌู"></textarea>
                        </div>

                        <div class="upload-box">
                            <div class="upload-icon">โช</div>
                            <p>ุงุฑูุน ุตูุฑุฉ</p>
                        </div>

                        <div class="section-divider"></div>
                        <h3 class="section-title">ุชูุงุตูู ุงูุนุฑุถ</h3>

                        <div class="form-group">
                            <label>ุงููุฏููุฉ</label>
                            <select id="reqCity">
                                <option value="">ุงุฎุชุฑ ุงููุฏููุฉ</option>
                                <option value="jeddah">ุฌุฏุฉ</option>
                                <option value="riyadh">ุงูุฑูุงุถ</option>
                                <option value="dammam">ุงูุฏูุงู</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>ุชุตููุฉ ุงูุนุฑูุถ</label>
                            <select id="reqFilter">
                                <option value="default">ุงูุชุฑุงุถู</option>
                                <option value="price_low">ุงูุฃูู ุณุนุฑูุง</option>
                                <option value="price_high">ุงูุฃุนูู ุชูููููุง</option>
                                <option value="closest">ุงูุฃูุฑุจ</option>
                            </select>
                        </div>

                        <div class="form-group checkbox-row inline">
                            <label><input type="checkbox" id="reqNoteMore"> ูู ุชุฑุบุจ ูู ุฅุถุงูุฉ ูุทุนุฉ ุฃุฎุฑู ุ</label>
                            <label><input type="checkbox" id="reqDelivery"> ุชูุตูู ุงูุทูุจ ูู.</label>
                        </div>
                        <div class="form-group checkbox-row">
                            <label><input type="checkbox" id="reqAgree"> ุงูุงูู ุนูู ุงูุดุฑูุท ูุงูุฃุญูุงู.</label>
                        </div>
                        <div class="step-actions">
                            <button class="ghost-btn" data-back="year">ุงูุณุงุจู</button>
                            <button class="pill" id="submitRequest">ุฅุฑุณุงู ุงูุทูุจ</button>
                        </div>
                    </div>
                </section>

                <section id="offersSection" class="app-section">
                    <div class="section-block">
                        <h2>ุงูุนุฑูุถ</h2>
                        <div id="offersList" class="empty-state">ูุง ููุฌุฏ ุนุฑูุถ ุจุนุฏ</div>
                    </div>
                </section>

                <section id="profileSection" class="app-section">
                    <div class="section-block profile-card">
                        <div class="profile-header">
                            <div>
                                <p class="hero-eyebrow">ุญุณุงุจู</p>
                                <h2>ุงูููู ุงูุดุฎุตู</h2>
                            </div>
                        </div>
                        <div class="profile-rows">
                            <div class="profile-row">
                                <span class="label">ุงูุงุณู</span>
                                <span id="profileName" class="value">โ</span>
                            </div>
                            <div class="profile-row">
                                <span class="label">ุฑูู ุงูุฌูุงู</span>
                                <span id="profilePhone" class="value">โ</span>
                            </div>
                            <div class="profile-row">
                                <span class="label">ุงููุฏููุฉ</span>
                                <span id="profileCity" class="value">โ</span>
                            </div>
                            <div class="profile-row">
                                <span class="label">ููุน ุงูุญุณุงุจ</span>
                                <span id="profileRole" class="value">โ</span>
                            </div>
                        </div>
                        <div class="profile-actions">
                            <button id="logoutBtn" class="ghost-btn">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
                            <button id="deleteAccountBtn" class="danger-btn">ุญุฐู ุงูุญุณุงุจ</button>
                        </div>
                    </div>
                </section>
            </main>

            <nav class="bottom-nav">
                <button class="nav-btn active" data-target="homeSection">
                    <span class="nav-icon nav-home"></span>
                    <span class="nav-label">ุงูุฑุฆูุณูุฉ</span>
                </button>
                <button class="nav-btn" data-target="requestSection">
                    <span class="nav-icon nav-request"></span>
                    <span class="nav-label">ุงูุทูุจุงุช</span>
                </button>
                <button class="nav-btn" data-target="offersSection">
                    <span class="nav-icon nav-offers"></span>
                    <span class="nav-label">ุนุฑูุถู</span>
                </button>
                <button class="nav-btn" data-target="profileSection">
                    <span class="nav-icon nav-profile"></span>
                    <span class="nav-label">ุญุณุงุจู</span>
                </button>
            </nav>
        </div>

        <!-- Login Modal -->
        <div id="loginModal" class="modal">
            <div class="modal-backdrop" onclick="closeLogin()"></div>
            <div class="modal-content">
                <h2>ุชุณุฌูู ุงูุฏุฎูู</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginPhone">ุฑูู ุงูุฌูุงู</label>
                        <div class="phone-field">
                            <div class="phone-control">
                                <button type="button" class="phone-flag-btn" aria-label="ุงุฎุชุฑ ุงูุฏููุฉ">๐ธ๐ฆ +966</button>
                                <span class="phone-separator"></span>
                                <input type="tel" id="loginPhone" name="loginPhone" class="phone-input" placeholder="5xxxxxxxx" required>
                            </div>
                        </div>
                    </div>
                    <div id="loginError" class="form-hint error-text" aria-live="polite"></div>
                    <button type="submit" class="submit-btn">ุฏุฎูู</button>
                    <button type="button" class="ghost-btn" onclick="closeLogin()">ุฅูุบุงุก</button>
                </form>
            </div>
        </div>

        <!-- Pledge Modal -->
        <div id="pledgeModal" class="modal">
            <div class="modal-backdrop" onclick="closePledge()"></div>
            <div class="modal-content pledge-card">
                <h3>ุชุนูุฏ</h3>
                <p class="pledge-text">
                    ุฃููุณู ุจุงููู ุงูุนุธูู ุฃูู ูู ุญุงู ุชููุช ุนูููุฉ ุงูุจูุน ุนุจุฑ ูุฐุง ุงูุชุทุจูู ุฃู ุจุณุจุจููุ ูุฅููู ุฃูุชุฒู ุจุชุญููู ุงููุณุชุญูุงุช ุฎูุงู 3 ุฃูุงู ุนุจุฑ โูุณู ูุณุชุญูุงุช ุงูุชุทุจูู ูู ูููู ุงูุดุฎุตูโุ ูุงููู ูุทููุน ุนูู ูููุงุชู ูุชุนุงููุงุชู:
                </p>
                <ul class="pledge-list">
                    <li>ููุนูููุงุช ุงูุชู ุชูู ุนู 1000 ุฑูุงู: ุชุญููู ูุจูุบ 50 ุฑูุงู.</li>
                    <li>ููุนูููุงุช ุงูุชู ุชุจูุบ 1000 ุฑูุงู ูุฃูุซุฑ: ุชุญููู ูุณุจุฉ (15%) ูู ูููุฉ ุงูุณูุนุฉ.</li>
                </ul>
                <button type="button" class="pill" onclick="confirmPledge()">ุงุชุนูุฏ ุจุฐูู</button>
            </div>
        </div>

        <!-- Success Modal -->
        <div id="successModal" class="modal">
            <div class="modal-backdrop" onclick="closeSuccess()"></div>
            <div class="modal-content success-card">
                <div class="success-icon">โ</div>
                <h3>ุชู ุฅุฑุณุงู ุทูุจู ุจูุฌุงุญ!</h3>
                <p class="form-hint">ุจุงูุชุธุงุฑ ุนุฑูุถ ุงูุชุดุงููุญุ ุฏุงูู ูุฑูุจ.</p>
                <button type="button" class="pill" onclick="closeSuccess()">ุชู</button>
            </div>
        </div>

        <!-- App Message Modal -->
        <div id="appMessageModal" class="modal">
            <div class="modal-backdrop" onclick="closeAppMessage()"></div>
            <div class="modal-content">
                <p id="appMessageText" class="form-hint" style="text-align:center;"></p>
                <button type="button" class="pill" onclick="closeAppMessage()" style="margin-top:10px;">ุชู</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
